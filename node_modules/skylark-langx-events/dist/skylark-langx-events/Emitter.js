/**
 * skylark-langx-events - The skylark JavaScript language extension library.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["skylark-langx-types","skylark-langx-objects","skylark-langx-arrays","skylark-langx-klass","./events","./Event","./Listener"],function(t,n,i,r,e,a,s){var o=Array.prototype.slice,h=i.compact,u=t.isDefined,f=t.isPlainObject,l=t.isFunction,c=t.isString,p=(t.isEmptyObject,n.mixin);n.safeMixin;function d(t){var n=(""+t).split(".");return{name:n[0],ns:n.slice(1).join(" ")}}var v=s.inherit({_prepareArgs:function(t,n){return n=u(n)?[t].concat(n):[t]},on:function(t,n,i,r,e,a){var s=this,o=this._hub||(this._hub={});if(f(t))return e=r,each(t,function(t,r){s.on(t,n,i,r,e,a)}),this;if(c(n)||l(r)||(e=r,r=i,i=n,n=void 0),l(i)&&(e=r,r=i,i=null),!r)throw new Error("No callback function");if(!l(r))throw new Error("The callback  is not afunction");return c(t)&&(t=t.split(/\s/)),t.forEach(function(t){var s=d(t),h=s.name,u=s.ns;(o[h]||(o[h]=[])).push({fn:r,selector:n,data:i,ctx:e,ns:u,one:a})}),this},one:function(t,n,i,r,e){return this.on(t,n,i,r,e,1)},emit:function(t){if(!this._hub)return this;var n=this;c(t)&&(t=new a(t)),Object.defineProperty(t,"target",{value:this});var i=o.call(arguments,1);return i=this._prepareArgs(t,i),[t.type||t.name,"all"].forEach(function(r){var e=d(r),a=e.name,s=e.ns,o=n._hub[a];if(o){for(var u=o.length,f=!1,l=0;l<u;l++){if(t.isImmediatePropagationStopped&&t.isImmediatePropagationStopped())return this;var c=o[l];(!s||c.ns&&c.ns.startsWith(s))&&(t.data?c.data&&(t.data=p({},c.data,t.data)):t.data=c.data||null,c.fn.apply(c.ctx,i),c.one&&(o[l]=null,f=!0))}f&&(n._hub[r]=h(o))}}),this},listened:function(t){return((this._hub||(this._events={}))[t]||[]).length>0},off:function(t,n){var i=this._hub||(this._hub={});return c(t)&&(t=t.split(/\s/)),t.forEach(function(t){var r=d(t),e=r.name,a=r.ns,s=i[e];if(s){var o=[];if(n||a)for(var h=0,u=s.length;h<u;h++)n&&s[h].fn!==n&&s[h].fn._!==n?o.push(s[h]):!a||s[h].ns&&0==s[h].ns.indexOf(a)||o.push(s[h]);o.length?i[e]=o:delete i[e]}}),this},trigger:function(){return this.emit.apply(this,arguments)}});return e.Emitter=v});
//# sourceMappingURL=sourcemaps/Emitter.js.map
