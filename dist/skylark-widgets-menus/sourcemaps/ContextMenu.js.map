{"version":3,"sources":["ContextMenu.js"],"names":["define","Vector2","geom","Panel","menus","ButtonMenu","DropdownMenu","ContextMenu","inherit","_construct","parent","prototype","call","this","self","_elm","style","position","overflow","zIndex","onmouseleave","destroy","offset","items","setText","text","removeItem","index","length","splice","addItem","name","callback","button","setAlignment","Text","LEFT","x","setOnClick","push","addMenu","menu","setDirection","showArrow","setMargin","updateItems","i","size","copy","set","y","updateInterface","updateSize","width","height","updatePosition","top","left","out","testAxis","addOption","removeOption","updateOption"],"mappings":";;;;;;;AAAAA,QACC,iCACA,oBACA,oCACA,WACA,eACA,kBACC,SACDC,EACAC,EAEAC,EACAC,EACAC,EACAC,GAEA,aASA,IAAIC,EAAcJ,EAAMK,SAEvBC,WAAa,SAAUC,GACtBP,EAAMQ,UAAUF,WAAWG,KAAKC,KAAMH,EAAQ,OAE9C,IAAII,EAAOD,KAEXA,KAAKE,KAAKC,MAAMC,SAAW,WAC3BJ,KAAKE,KAAKC,MAAME,SAAW,UAC3BL,KAAKE,KAAKC,MAAMG,OAAS,MACzBN,KAAKE,KAAKK,aAAe,WACxBN,EAAKO,WAGNR,KAAKS,OAAS,IAAIrB,EAAQ,GAAI,IAQ9BY,KAAKU,UAUNC,QAAU,SAASC,GAClBZ,KAAKY,KAAKD,QAAQC,IASnBC,WAAa,SAASC,GAClBA,GAAS,GAAKA,EAAQd,KAAKU,MAAMK,SACnCf,KAAKU,MAAMI,GAAON,UAClBR,KAAKU,MAAMM,OAAOF,EAAO,KAW3BG,QAAU,SAASC,EAAMC,GACxB,IAAIC,EAAS,IAAI5B,EAAWQ,MAC5BoB,EAAOlB,KAAKC,MAAMG,OAAS,QAC3Bc,EAAOT,QAAQO,GACfE,EAAOC,aAAaC,KAAKC,MACzBH,EAAOhB,SAASoB,EAAI,GAEpB,IAAIvB,EAAOD,KACXoB,EAAOK,WAAW,WACjBN,IACAlB,EAAKO,YAGNR,KAAKU,MAAMgB,KAAKN,IAUjBO,QAAU,SAAST,GAClB,IAAIU,EAAO,IAAInC,EAAaO,MAS5B,OARA4B,EAAKjB,QAAQO,GACbU,EAAKC,aAAapC,EAAa8B,MAC/BK,EAAKE,YACLF,EAAKP,aAAaC,KAAKC,MACvBK,EAAKG,UAAU,IAEf/B,KAAKU,MAAMgB,KAAKE,GAETA,GAQRI,YAAc,WACb,IAAI,IAAIC,EAAI,EAAGA,EAAIjC,KAAKU,MAAMK,OAAQkB,IAErCjC,KAAKU,MAAMuB,GAAGC,KAAKC,KAAKnC,KAAKkC,MAC7BlC,KAAKU,MAAMuB,GAAG7B,SAASgC,IAAI,EAAGpC,KAAKkC,KAAKG,EAAIJ,GAC5CjC,KAAKU,MAAMuB,GAAGK,mBAIhBC,WAAa,WACZvC,KAAKE,KAAKC,MAAMqC,MAAQxC,KAAKkC,KAAKV,EAAI,KACtCxB,KAAKE,KAAKC,MAAMsC,OAAUzC,KAAKkC,KAAKG,EAAIrC,KAAKU,MAAMK,OAAU,KAE7Df,KAAKgC,eAGNU,eAAiB,WAChB1C,KAAKE,KAAKC,MAAMwC,IAAO3C,KAAKI,SAASiC,EAAIrC,KAAKS,OAAO4B,EAAK,KAC1DrC,KAAKE,KAAKC,MAAMyC,KAAQ5C,KAAKI,SAASoB,EAAIxB,KAAKS,OAAOe,EAAK,KAK3D,IAAIqB,EAAMxD,EAAKyD,SAAS9C,KAAKE,MAChB,IAAV2C,EAAIrB,IAENxB,KAAKE,KAAKC,MAAMyC,KAAQ5C,KAAKI,SAASoB,EAAIxB,KAAKS,OAAOe,EAAIxB,KAAKkC,KAAKV,EAAK,MAE7D,IAAVqB,EAAIR,IAENrC,KAAKE,KAAKC,MAAMwC,IAAO3C,KAAKI,SAASiC,EAAIrC,KAAKS,OAAO4B,EAAIQ,EAAIR,EAAK,SAUrE,OAJA3C,EAAYI,UAAUiD,UAAYrD,EAAYI,UAAUmB,QACxDvB,EAAYI,UAAUkD,aAAetD,EAAYI,UAAUe,WAC3DnB,EAAYI,UAAUmD,aAAevD,EAAYI,UAAUkC,YAEpDzC,EAAMG,YAAcA","file":"../ContextMenu.js","sourcesContent":["define([\r\n\t\"skylark-langx-numerics/Vector2\",\r\n\t\"skylark-domx-geom\",\r\n\t\"skylark-widgets-base/panels/Panel\",\r\n\t\"../menus\",\r\n\t\"./ButtonMenu\",\r\n\t\"./DropdownMenu\"\r\n],function(\r\n\tVector2,\r\n\tgeom,\r\n\r\n\tPanel,\r\n\tmenus,\r\n\tButtonMenu,\r\n\tDropdownMenu\r\n){\r\n\t\"use strict\";\r\n\r\n\t/**\r\n\t * Context menu widget.\r\n\t * \r\n\t * @class ContextMenu\r\n\t * @extends {Panel}\r\n\t * @param {Widget} parent Parent widget.\r\n\t */\r\n\tvar ContextMenu = Panel.inherit({\r\n\r\n\t\t_construct : function (parent) {\t\r\n\t\t\tPanel.prototype._construct.call(this, parent, \"div\");\r\n\r\n\t\t\tvar self = this;\r\n\r\n\t\t\tthis._elm.style.position = \"absolute\";\r\n\t\t\tthis._elm.style.overflow = \"visible\";\r\n\t\t\tthis._elm.style.zIndex = \"300\";\r\n\t\t\tthis._elm.onmouseleave = function()\t{\r\n\t\t\t\tself.destroy();\r\n\t\t\t};\r\n\r\n\t\t\tthis.offset = new Vector2(20, 10);\r\n\t\t\t\r\n\t\t\t/**\r\n\t\t\t * Items in this menu.\r\n\t\t\t * \r\n\t\t\t * @attribute items\r\n\t\t\t * @type {Array}\r\n\t\t\t */\r\n\t\t\tthis.items = [];\r\n\t\t},\r\n\r\n\r\n\t\t/**\r\n\t\t * Set the text of this context menu.\r\n\t\t * \r\n\t\t * @method setText\r\n\t\t * @param {String} text\r\n\t\t */\r\n\t\tsetText : function(text) {\r\n\t\t\tthis.text.setText(text);\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Remove item from context menu.\r\n\t\t *\r\n\t\t * @method removeItem\r\n\t\t * @param {Number} index\r\n\t\t */\r\n\t\tremoveItem : function(index) {\r\n\t\t\tif(index >= 0 && index < this.items.length)\t{\r\n\t\t\t\tthis.items[index].destroy();\r\n\t\t\t\tthis.items.splice(index, 1);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Add new item to context menu\r\n\t\t *\r\n\t\t * @method addItem\r\n\t\t * @param {String} name of the item\r\n\t\t * @param {Function} callback Callback function\r\n\t\t */\r\n\t\taddItem : function(name, callback) {\r\n\t\t\tvar button = new ButtonMenu(this);\r\n\t\t\tbutton._elm.style.zIndex = \"10000\";\r\n\t\t\tbutton.setText(name);\r\n\t\t\tbutton.setAlignment(Text.LEFT);\r\n\t\t\tbutton.position.x = 25;\r\n\r\n\t\t\tvar self = this;\r\n\t\t\tbutton.setOnClick(function(){\r\n\t\t\t\tcallback();\r\n\t\t\t\tself.destroy();\r\n\t\t\t});\r\n\r\n\t\t\tthis.items.push(button);\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Add new menu to context menu\r\n\t\t *\r\n\t\t * @method addItem\r\n\t\t * @param {String} name of the item.\r\n\t\t * @return {DropdownMenu} The new menu created.\r\n\t\t */\r\n\t\taddMenu : function(name) {\r\n\t\t\tvar menu = new DropdownMenu(this);\r\n\t\t\tmenu.setText(name);\r\n\t\t\tmenu.setDirection(DropdownMenu.LEFT);\r\n\t\t\tmenu.showArrow();\r\n\t\t\tmenu.setAlignment(Text.LEFT);\r\n\t\t\tmenu.setMargin(25);\r\n\r\n\t\t\tthis.items.push(menu);\r\n\r\n\t\t\treturn menu;\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Update all items in the menu.\r\n\t\t * \r\n\t\t * @method updateItems\r\n\t\t */\r\n\t\tupdateItems : function() {\r\n\t\t\tfor(var i = 0; i < this.items.length; i++)\r\n\t\t\t{\r\n\t\t\t\tthis.items[i].size.copy(this.size);\r\n\t\t\t\tthis.items[i].position.set(0, this.size.y * i);\r\n\t\t\t\tthis.items[i].updateInterface();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tupdateSize : function()\t{\r\n\t\t\tthis._elm.style.width = this.size.x + \"px\";\r\n\t\t\tthis._elm.style.height = (this.size.y * this.items.length) + \"px\";\r\n\r\n\t\t\tthis.updateItems();\r\n\t\t},\r\n\r\n\t\tupdatePosition : function() {\r\n\t\t\tthis._elm.style.top = (this.position.y - this.offset.y) + \"px\";\r\n\t\t\tthis._elm.style.left = (this.position.x - this.offset.x) + \"px\";\r\n\r\n\t\t\t//Check if its inside window\r\n\t\t\t\r\n\t\t\t//var out = DOMUtils.checkBorder(this._elm);\r\n\t\t\tvar out = geom.testAxis(this._elm);\r\n\t\t\tif(out.x !== 0)\r\n\t\t\t{\r\n\t\t\t\tthis._elm.style.left = (this.position.x + this.offset.x - this.size.x) + \"px\"; \r\n\t\t\t}\r\n\t\t\tif(out.y !== 0)\r\n\t\t\t{\r\n\t\t\t\tthis._elm.style.top = (this.position.y - this.offset.y - out.y) + \"px\";\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t});\r\n\r\n\tContextMenu.prototype.addOption = ContextMenu.prototype.addItem;\r\n\tContextMenu.prototype.removeOption = ContextMenu.prototype.removeItem;\r\n\tContextMenu.prototype.updateOption = ContextMenu.prototype.updateItems;\r\n\r\n\treturn menus.ContextMenu = ContextMenu;\r\n});"]}